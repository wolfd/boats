(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63518,       1550]
NotebookOptionsPosition[     63276,       1537]
NotebookOutlinePosition[     63616,       1552]
CellTagsIndexPosition[     63573,       1549]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<BoatContext`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"DEBUG", " ", "THING"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "debug", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"debug", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"debug", "[", "code_", "]"}], ":=", 
   RowBox[{"Internal`InheritedBlock", "[", 
    RowBox[{
     RowBox[{"{", "Message", "}"}], ",", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "inMessage", "}"}], ",", 
        RowBox[{
         RowBox[{"Unprotect", "[", "Message", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Message", "[", "args___", "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Hold", "[", "args", "]"}], "]"}], ",", "_$Off"}], 
             "]"}]}]}], ":=", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"inMessage", "=", "True"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shallow", "/@", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"HoldForm", "[", 
                    RowBox[{"f_", "[", "___", "]"}], "]"}], "\[RuleDelayed]", 
                    
                    RowBox[{"HoldForm", "[", "f", "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Short", ",", 
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "Red"}], "]"}]}], 
                  "}"}], "&"}], "@", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Stack", "[", "_", "]"}], ",", 
                    RowBox[{"-", "7"}]}], "]"}], ",", "4"}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Message", "[", "args", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Throw", "[", 
               RowBox[{"$Failed", ",", "Message"}], "]"}], ";"}]}], "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"TrueQ", "[", "inMessage", "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Protect", "[", "Message", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Catch", "[", 
       RowBox[{
        RowBox[{"StackComplete", "[", "code", "]"}], ",", "Message"}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Find", " ", "all", " ", "roots", " ", "function"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "findAllRoots", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "findAllRoots", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<LocalVariables\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Plot\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"findAllRoots", ",", "HoldAll"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "findAllRoots", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<ShowPlot\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "}"}], ",", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"Options", "[", "Plot", "]"}], ",", 
        RowBox[{"Except", "[", "PlotRange", "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"findAllRoots", "[", 
    RowBox[{"fn_", ",", 
     RowBox[{"{", 
      RowBox[{"l_", ",", "lmin_", ",", "lmax_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pl", ",", "p", ",", "x", ",", "localFunction", ",", "brackets"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"localFunction", "=", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", "fn", "]"}], "/.", 
         RowBox[{
          RowBox[{"HoldPattern", "[", "l", "]"}], "\[RuleDelayed]", "x"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"lmin", "\[NotEqual]", "lmax"}], ",", 
        RowBox[{
         RowBox[{"pl", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{"localFunction", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "lmin", ",", "lmax"}], "}"}], ",", 
            RowBox[{"Evaluate", "@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "opts", "}"}], ",", 
                 RowBox[{"Options", "[", "findAllRoots", "]"}]}], "]"}], ",", 
               
               RowBox[{"Options", "[", "Plot", "]"}]}], "]"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"pl", ",", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", "x__", "}"}], "]"}], "\[RuleDelayed]", "x"}], ",", 
            "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<ShowPlot\>\"", "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"Show", "[", 
             RowBox[{"pl", ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<Finding roots for this function\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"FontSize", "\[Rule]", "8"}], "}"}]}]}], "]"}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"brackets", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", 
         RowBox[{"Select", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "This", " ", "Split", " ", "trick", " ", "pretends", " ", "that", 
             " ", "two", " ", "points", " ", "on", " ", "the", " ", "curve", 
             " ", "are", " ", "\"\<equal\>\"", " ", "if", " ", "the", " ", 
             "function", " ", "values", " ", "have", " ", "_opposite", " ", 
             "_", " ", 
             RowBox[{"sign", ".", "Pairs"}], " ", "of", " ", "such", " ", 
             "sign"}], "-", 
            RowBox[{
            "changes", " ", "form", " ", "the", " ", "brackets", " ", "for", 
             " ", "the", " ", "subsequent", " ", "FindRoot"}]}], "*)"}], 
          RowBox[{
           RowBox[{"Split", "[", 
            RowBox[{"p", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"Last", "[", "#2", "]"}], "]"}], "\[Equal]", 
               RowBox[{"-", 
                RowBox[{"Sign", "[", 
                 RowBox[{"Last", "[", "#1", "]"}], "]"}]}]}], "&"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#1", "]"}], "\[Equal]", "2"}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "/.", 
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"localFunction", "\[Equal]", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "##1"}], "}"}]}], "]"}], "&"}], ",", 
          "brackets", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], "/.", 
       RowBox[{"x", "\[Rule]", 
        RowBox[{"{", "}"}]}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Standard", " ", "Boat", " ", "Library"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelNeeds", "[", "\"\<CUDALink`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "point", " ", "cloud", " ", "from", " ", 
    "BoundaryMeshRegion"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointCloud", "[", 
     RowBox[{
      RowBox[{"reg_", "?", "RegionQ"}], ",", "numPoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"RandomPoint", "[", 
     RowBox[{"reg", ",", "numPoints"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "sortPoints", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sortPoints", "[", 
     RowBox[{"pts_", ",", "normal_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sortPoints", "[", 
      RowBox[{"pts", ",", "normal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"False", ",", "\[IndentingNewLine]", 
       RowBox[{"CUDASort", "[", 
        RowBox[{"CUDADot", "[", 
         RowBox[{"pts", ",", "normal"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "normal"}], "&"}], "/@", "pts"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"canLocationFinder", "[", 
     RowBox[{"comHull_", ",", "distanceFromCOM_", ",", "deltaHeight_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"comHull", "+", 
         RowBox[{"{", 
          RowBox[{"distanceFromCOM", ",", "0", ",", "deltaHeight"}], "}"}]}], 
        ",", 
        RowBox[{"comHull", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "distanceFromCOM"}], ",", "0", ",", "deltaHeight"}], 
          "}"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mastLocationFinder", "[", 
     RowBox[{"comHull_", ",", "deltaHeight_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"comHull", "+", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "deltaHeight"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ballastLocationFinder", "[", 
    RowBox[{"comHull_", ",", "deltaHeight_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"comHull", "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "deltaHeight"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"regionBounds", "[", "boat_", "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "hull", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hull", "=", 
        RowBox[{"region", "/.", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"boat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RegionBounds", "[", "hull", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "waterLineOld", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "index", " ", "that", " ", "puts", " ", "a", 
    " ", "certain", " ", "portion", " ", "of", " ", "the", " ", "volume", " ",
     "underwater"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"waterLineOld", "[", 
     RowBox[{
     "pts_", ",", "normal_", ",", "meshVolume_", ",", "volumeUnderwater_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"waterLineOld", "[", 
      RowBox[{
      "pts", ",", "normal", ",", "meshVolume", ",", "volumeUnderwater"}], 
      "]"}], "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numPoints", ",", "dists"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numPoints", "=", 
         RowBox[{
          RowBox[{"volumeUnderwater", "/", "meshVolume"}], " ", "*", " ", 
          RowBox[{"Length", "[", "pts", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dists", "=", 
         RowBox[{"sortPoints", "[", 
          RowBox[{"pts", ",", "normal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Possible", " ", 
          RowBox[{"improvement", ":", " ", 
           RowBox[{
           "linear", " ", "interpolate", " ", "between", " ", "values", " ", 
            "at", " ", "two", " ", "points"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dists", "[", 
         RowBox[{"[", 
          RowBox[{"Floor", "[", "numPoints", "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "waterLine", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"waterLine", "[", 
     RowBox[{"boat_", ",", "normal_", ",", "desiredVolumeUnderwater_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"waterLine", "[", 
      RowBox[{"boat", ",", "normal", ",", "desiredVolumeUnderwater"}], "]"}], 
     "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "bPoints", ",", "fullySubmergedVolume", 
         ",", "indexOfWaterLine", ",", "pointDistances"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Only", " ", "one", " ", "buoy", " ", "object", " ", "per", " ", 
           "boat", " ", "is", " ", "allowed"}], ",", " ", 
          RowBox[{
          "due", " ", "to", " ", "different", " ", "point", " ", "masses"}]}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "buoys", "]"}], "\[NotEqual]", "1"}], ",", 
          RowBox[{
          "Throw", "[", "\"\<No don't do that, one buoy per boat please\>\"", 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "These", " ", "operations", " ", "are", " ", "for", " ", "many", 
           " ", "buoys"}], ",", " ", 
          RowBox[{
          "but", " ", "only", " ", "one", " ", "buoy", " ", "is", " ", 
           "valid"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fullySubmergedVolume", "=", 
         RowBox[{"volume", "/.", "buoy"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bPoints", "=", 
         RowBox[{"points", "/.", "buoy"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "how", " ", "many", " ", "points", " ", "are", " ", 
          "underwater"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexOfWaterLine", "=", 
         RowBox[{
          RowBox[{"desiredVolumeUnderwater", "/", "fullySubmergedVolume"}], 
          "*", 
          RowBox[{"Length", "[", "bPoints", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Index", " ", "must", " ", "be", " ", "in", " ", "range", " ", "of", 
          " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indexOfWaterLine", "<", "1"}], ",", 
          RowBox[{"Throw", "[", "\"\<Index not >= 1\>\"", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indexOfWaterLine", ">", 
           RowBox[{"Length", "[", "bPoints", "]"}]}], ",", 
          RowBox[{"Throw", "[", "\"\<Index > number of points\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pointDistances", "=", 
         RowBox[{"sortPoints", "[", 
          RowBox[{"bPoints", ",", "normal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Possible", " ", 
          RowBox[{"improvement", ":", " ", 
           RowBox[{
           "linear", " ", "interpolate", " ", "between", " ", "values", " ", 
            "at", " ", "two", " ", "points"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pointDistances", "[", 
         RowBox[{"[", 
          RowBox[{"Floor", "[", "indexOfWaterLine", "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateVolumeUnderwater", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateVolumeUnderwater", "[", "boat_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"boatMass", ",", "displacedWaterVolume"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"boatMass", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"p", "[", "mass", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{"Select", "[", 
              RowBox[{"boat", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
                 "\"\<PointMass\>\""}], "&"}]}], "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"displacedWaterVolume", "=", 
         RowBox[{"boatMass", "/", "waterDensity"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateWaterLine", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calculateWaterLine", "[", 
    RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"calculateWaterLine", "[", 
     RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"waterLine", "[", 
     RowBox[{"boat", ",", "wNormal", ",", 
      RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateForces", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateForces", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateForce", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "weightForces", ",", 
         "buoyancyForce"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "the", " ", "forces"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoyancyForce", "=", 
         RowBox[{
          RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}], "*", 
          "waterDensity", "*", "g", "*", "wNormal"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"weightForces", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", 
            RowBox[{"(", 
             RowBox[{"g", "*", 
              RowBox[{"-", "wNormal"}]}], ")"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"mass", "/.", "masses"}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Tricky", " ", "replacement", " ", "bullshit"}], " ", "*)"}],
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wfs", "\[Rule]", " ", "weightForces"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"bf", "\[Rule]", "buoyancyForce"}]}], "\[IndentingNewLine]",
          "|>"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "points", " ", "of", " ", "the", " ", "buoyHull", 
    " ", "of", " ", "a", " ", "boat", " ", "when", " ", "translational", " ", 
    "forces", " ", "are", " ", "at", " ", "equib"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "pointsBelowWaterLine", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsBelowWaterLine", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pointsBelowWaterLine", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"buoy", ",", "waterHeight"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoy", "=", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"boat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"waterHeight", "=", 
         RowBox[{"calculateWaterLine", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Dot", " ", "products"}], ",", " ", 
          RowBox[{
          "get", " ", "all", " ", "points", " ", "that", " ", "are", " ", 
           "below", " ", "the", " ", "water", " ", "height"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pointsBelowWater", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"points", "/.", "buoy"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", ".", "wNormal"}], "<=", "waterHeight"}], "&"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "total", " ", "COM", " ", "for", " ", "the", " ", 
    "boat"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateCOM", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateCOM", "[", "boat_", "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"calculateCOM", "[", "boat", "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"masses", ",", "coms", ",", "ms"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coms", "=", 
         RowBox[{"com", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ms", "=", 
         RowBox[{"mass", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{"coms", "*", "ms"}], ")"}]}], ")"}], "/", 
         "\[IndentingNewLine]", 
         RowBox[{"Plus", "@@", "ms"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "COB", " ", "of", " ", "a", " ", "boat", " ", 
    "when", " ", "translational", " ", "forces", " ", "are", " ", "at", " ", 
    "equib"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateCOB", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateCOB", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateCOB", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "points", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"points", "=", 
         RowBox[{"pointsBelowWaterLine", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "points"}], "}"}]}], "]"}], "/", 
           RowBox[{"Length", "[", "points", "]"}]}], ",", 
          "\"\<Centimeters\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "moment", " ", "vectors", " ", "that", " ", "the",
     " ", "boat", " ", "has"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateMoments", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateMoments", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateMoments", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "forces", ",", "buoyancy", 
         ",", "weights", ",", "buoyR", ",", "buoyMoment", ",", "weightsR", 
         ",", "weightsMoments"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "the", " ", "forces"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"forces", "=", 
         RowBox[{"calculateForces", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"weights", "=", 
         RowBox[{"wfs", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"buoyancy", "=", 
         RowBox[{"bf", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Buoyancy", " ", "moment"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoyR", "=", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"buoyMoment", "=", 
         RowBox[{"Cross", "[", 
          RowBox[{"buoyR", ",", "buoyancy"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "weights", " ", "moments"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"weightsR", "=", 
         RowBox[{"com", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"weightsMoments", "=", 
         RowBox[{"Cross", "@@@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"weightsR", ",", "weights"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Return", " ", "the", " ", "moments"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Prepend", "[", 
         RowBox[{"weightsMoments", ",", "buoyMoment"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorCircle", "[", 
     RowBox[{"up_", ",", "front_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"front", "\[Cross]", "up"}], "*", 
       RowBox[{"Sin", "[", "#", "]"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"up", "*", 
       RowBox[{"Cos", "[", "#", "]"}]}]}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avsDefaults", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"UpVec", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
      RowBox[{"FrontVec", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculate", " ", "the", " ", "righting", " ", "arm", " ", "distance"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightingArm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "rightingArm", "]"}], "=", "avsDefaults"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rightingArm", "[", 
     RowBox[{"boat_", ",", "wNormal_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rightingArm", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "cob", ",", "com", ",", 
         "left", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"cob", "=", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"com", "=", 
         RowBox[{"calculateCOM", "[", "boat", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"left", "=", 
         RowBox[{"wNormal", "\[Cross]", 
          RowBox[{"Normalize", "[", 
           RowBox[{"OptionValue", "[", "FrontVec", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"cob", "-", "com"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", ".", "left"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Calculate", " ", "the", " ", "AVS", " ", "function"}], ",", " ", 
    
    RowBox[{
    "interpolated", " ", "from", " ", "a", " ", "number", " ", "of", " ", 
     "points"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateAVS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "calculateAVS", "]"}], "=", "avsDefaults"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateAVS", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", "range_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateAVS", "[", 
      RowBox[{"boat", ",", "samplePoints", ",", "range", ",", "opts"}], "]"}],
      "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"angleVec", ",", "avses", ",", "interp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angleVec", "=", 
         RowBox[{"vectorCircle", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "UpVec", "]"}], ",", 
           RowBox[{"OptionValue", "[", "FrontVec", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"avses", "=", 
         RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rightingArm", "[", 
            RowBox[{"boat", ",", 
             RowBox[{"angleVec", "[", "\[Theta]", "]"}], ",", "opts"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", 
             RowBox[{"range", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"range", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"range", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"range", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
              "samplePoints"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListInterpolation", "[", "\[IndentingNewLine]", 
         RowBox[{"avses", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "intersection", " ", "points", " ", "in", " ", "the", " ", 
    "AVS", " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAVSPoints", "[", 
     RowBox[{"fAVS_", ",", "range_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"findAllRoots", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", 
       RowBox[{"fAVS", "[", "\[Theta]", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"range", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"range", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "-", 
    RowBox[{"Pi", " ", "to", " ", "Pi", " ", "for", " ", "AVS"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "plotCircleAVS", "]"}], "=", "avsDefaults"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotCircleAVS", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"plotAVS", "[", 
     RowBox[{"boat", ",", "samplePoints", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "opts"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "plotAVS", "]"}], "=", "avsDefaults"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotAVS", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", "range_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"maxAngle", "=", "Pi"}], ",", "avses", ",", "interp", ",", 
        "avsPoints"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interp", "=", 
        RowBox[{"calculateAVS", "[", 
         RowBox[{"boat", ",", "samplePoints", ",", "range", ",", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "calculateAVS", "]"}]}], "]"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"avsPoints", "=", 
        RowBox[{"getAVSPoints", "[", 
         RowBox[{"interp", ",", "range"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interp", "[", "\[Theta]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<AVS\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"range", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "8"}]}], 
             "]"}], ",", "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", "0"}], "}"}], "]"}], "&"}], "/@", 
             "avsPoints"}], "}"}], "\[IndentingNewLine]", "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "manyBoats", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{"avsDefaults", ",", 
     RowBox[{"{", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"manyBoats", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"maxAngle", "=", "Pi"}], ",", "angleVec"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"angleVec", "=", 
        RowBox[{"vectorCircle", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "UpVec", "]"}], ",", 
          RowBox[{"OptionValue", "[", "FrontVec", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"renderBoatWithForces", "[", 
            RowBox[{"boat", ",", 
             RowBox[{"angleVec", "[", "\[Theta]", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"OptionValue", "[", "ViewPoint", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"-", "maxAngle"}], ",", "maxAngle", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maxAngle", "*", "2"}], ")"}], "/", "samplePoints"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderBoat", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "wl", ",", "waterPlane", ",", "pointMassParts", ",", "buoyParts", ",", 
        "cob", ",", "frontVec"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Calculate", " ", "waterline", " ", "to", " ", "plot", " ", "plane", 
        " ", "on"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"wl", "=", 
        RowBox[{"calculateWaterLine", "[", 
         RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"waterPlane", "=", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
          RowBox[{"HalfSpace", "[", 
           RowBox[{"wNormal", ",", 
            RowBox[{"wNormal", "*", "wl"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Grab", " ", "all", " ", "point", " ", "masses", " ", "to", " ", 
         "render"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pointMassParts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"boat", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
            "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Render", " ", "buoy"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"buoyParts", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cob", "=", 
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"waterPlane", ",", 
          RowBox[{"render", "/.", "pointMassParts"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cobRender", "/.", "buoyParts"}], ")"}], "@", "cob"}]}], 
         "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderBoatWithForces", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "forces", ",", "wForces", ",", "bForce", ",", "momentSum", ",", "com", 
        ",", "scale", ",", "arrow", ",", "text", ",", "wVecs", ",", "bVec", 
        ",", "mVecs", ",", "mText"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"forces", "=", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"calculateForces", "[", 
           RowBox[{"boat", ",", "wNormal"}], "]"}], ",", "\"\<Newtons\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"wForces", "=", 
        RowBox[{"wfs", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bForce", "=", 
        RowBox[{"bf", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"momentSum", "=", 
        RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plus", "@@", 
           RowBox[{"calculateMoments", "[", 
            RowBox[{"boat", ",", "wNormal"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\"\<NewtonMeters\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"com", "=", 
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"calculateCOM", "[", "boat", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"arrow", "=", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"com", ",", 
            RowBox[{"com", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"QuantityMagnitude", "[", "#", "]"}], "*", "scale"}], 
              ")"}]}]}], "}"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"text", "=", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#", ",", 
           RowBox[{"com", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"QuantityMagnitude", "[", "#", "]"}], "*", "scale"}], 
             ")"}]}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"wVecs", "=", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"arrow", "/@", "wForces"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bVec", "=", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"arrow", "@", "bForce"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Arbitrary", " ", "numbers", " ", "to", " ", "scale"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mVecs", "=", 
        RowBox[{"{", 
         RowBox[{"Purple", ",", 
          RowBox[{"arrow", "@", 
           RowBox[{"(", 
            RowBox[{"momentSum", "*", "20"}], ")"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mText", "=", 
        RowBox[{"{", 
         RowBox[{"text", "@", "momentSum"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"renderBoat", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}], ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"wVecs", ",", "bVec", ",", "mVecs"}], "}"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"boatSummary", "[", "boat_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"up", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
        RowBox[{"range", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], ",", "avsPoints", ",", 
        "avsPointsDisp", ",", "avsTrim"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"avsPoints", "=", 
        RowBox[{
         RowBox[{"getAVSPoints", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"calculateAVS", "[", 
            RowBox[{"boat", ",", "20", ",", "range", ",", 
             RowBox[{"FrontVec", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "range"}], "]"}], "/", "Degree"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"avsPointsDisp", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"d", 
             
             TemplateBox[{
              InterpretationBox["\[InvisibleSpace]", 1],
               RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}],"degrees",
               "\"AngularDegrees\""},
              "QuantityPostfix"]}], ",", 
            RowBox[{"{", 
             RowBox[{"d", ",", "avsPoints"}], "}"}]}], "]"}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"avsTrim", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Theta]", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"QuantityMagnitude", "[", 
              RowBox[{
               RowBox[{"calculateAVS", "[", 
                RowBox[{"boat", ",", "20", ",", "range", ",", 
                 RowBox[{"FrontVec", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "]"}], "[", 
               "\[Theta]", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "0"}], "}"}]}], "]"}]}], ")"}], "/", 
         "Degree"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Boat\>\"", ",", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"renderBoat", "[", 
                RowBox[{"boat", ",", "up"}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<AVS Plot\>\"", ",", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"plotAVS", "[", 
                RowBox[{"boat", ",", "20", ",", "range"}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<AVS Zeros\>\"", ",", "avsPointsDisp"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Trim AVS\>\"", ",", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"plotAVS", "[", 
                RowBox[{"boat", ",", "20", ",", "range", ",", 
                 RowBox[{"FrontVec", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Trim\>\"", ",", 
             RowBox[{"avsTrim", 
              
              TemplateBox[{
               InterpretationBox["\[InvisibleSpace]", 1],
                RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}],"degrees",
                "\"AngularDegrees\""},
               "QuantityPostfix"]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
         ",", 
         RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.664813299496937*^9, 3.6648133170510674`*^9}, {
   3.66481350271585*^9, 3.664813508043021*^9}, {3.664814672840811*^9, 
   3.6648146739448757`*^9}, {3.664814711701421*^9, 3.664814734598516*^9}, {
   3.664814795939459*^9, 3.664814802663377*^9}, {3.664814852468903*^9, 
   3.664814872853755*^9}, {3.664814931411129*^9, 3.664814945699575*^9}, {
   3.664814984520199*^9, 3.664814995588686*^9}, {3.664815039581442*^9, 
   3.664815052791363*^9}, {3.664815101962479*^9, 3.664815124852728*^9}, {
   3.664815286900111*^9, 3.6648152927645273`*^9}, {3.6648154919480143`*^9, 
   3.6648156478657627`*^9}, {3.664815732893681*^9, 3.6648157330732718`*^9}, {
   3.664815771068974*^9, 3.664815779392758*^9}, 3.664815850460359*^9, {
   3.664815931513006*^9, 3.664815933768796*^9}, {3.6648880641112537`*^9, 
   3.6648882343374643`*^9}, {3.6648882926707163`*^9, 3.664888319009009*^9}, {
   3.664888394672628*^9, 3.664888480201806*^9}, {3.664888591280257*^9, 
   3.66488859264111*^9}, {3.6648888133280153`*^9, 3.664888867999805*^9}, {
   3.664909350225074*^9, 3.664909384945225*^9}, {3.664909480356393*^9, 
   3.664909521744224*^9}, {3.6649095579491177`*^9, 3.664909593831678*^9}, {
   3.664909642840949*^9, 3.664909678392852*^9}, {3.664909734698287*^9, 
   3.664909735306671*^9}, {3.664909781405867*^9, 3.66490979243357*^9}, {
   3.664909873664386*^9, 3.664909896201416*^9}, {3.664909941975493*^9, 
   3.664910024468048*^9}, {3.6649102702786407`*^9, 3.664910273537225*^9}, {
   3.664910646529241*^9, 3.664910706856591*^9}, {3.664910855055039*^9, 
   3.664910856417511*^9}, {3.664910968523501*^9, 3.664911004678432*^9}, {
   3.664911107672545*^9, 3.664911108988451*^9}, {3.664911189888356*^9, 
   3.6649112155614347`*^9}, {3.664911303591086*^9, 3.6649113192663527`*^9}, {
   3.6649119772896357`*^9, 3.664911992345685*^9}, 3.6649122416253023`*^9, {
   3.6649127779134207`*^9, 3.664912780459365*^9}, {3.664912816233697*^9, 
   3.664912817116675*^9}, {3.664915855720974*^9, 3.664915889340877*^9}, {
   3.6649165817587442`*^9, 3.6649165833106003`*^9}, {3.664916734097003*^9, 
   3.664916804078079*^9}, {3.6649169754324713`*^9, 3.664916976414856*^9}, {
   3.66491701538486*^9, 3.664917166987507*^9}, {3.664917215955248*^9, 
   3.6649172172397757`*^9}, {3.66491747583464*^9, 3.66491750582405*^9}, {
   3.664917572286017*^9, 3.6649176161853313`*^9}, {3.664917687054831*^9, 
   3.66491776105558*^9}, {3.6649177952342176`*^9, 3.66491779710802*^9}, {
   3.6649689947776823`*^9, 3.664969248723855*^9}, {3.66496930557377*^9, 
   3.664969317283692*^9}, {3.664969563018861*^9, 3.6649695925382547`*^9}, {
   3.664971382550474*^9, 3.664971399376328*^9}, {3.664971453504558*^9, 
   3.66497157163623*^9}, {3.664971850707279*^9, 3.664971880617313*^9}, {
   3.664973656342358*^9, 3.664973693004929*^9}, {3.6649740108189983`*^9, 
   3.664974060706532*^9}, {3.664974124110066*^9, 3.664974124778429*^9}, {
   3.6650490111538258`*^9, 3.66504904271038*^9}, {3.6650495158612747`*^9, 
   3.665049645855658*^9}, {3.6650496789246492`*^9, 3.665049700141054*^9}, {
   3.665049742111525*^9, 3.665049752696262*^9}, {3.665049806649321*^9, 
   3.665049823817503*^9}, {3.665049856766528*^9, 3.665049896619933*^9}, {
   3.6650499475161047`*^9, 3.665049967418483*^9}, {3.665050015945303*^9, 
   3.665050056986087*^9}, {3.665051375219232*^9, 3.665051535587358*^9}, {
   3.665052663464492*^9, 3.665052674180533*^9}, {3.665052775980123*^9, 
   3.665052803342299*^9}, {3.665053023430024*^9, 3.665053114066889*^9}, {
   3.665053146089345*^9, 3.6650531530527163`*^9}, {3.665053267770974*^9, 
   3.665053358015863*^9}, {3.665053440460099*^9, 3.665053440534911*^9}, {
   3.665053497089122*^9, 3.6650534979811974`*^9}, {3.6650535888140287`*^9, 
   3.665053629755579*^9}, {3.66505391190242*^9, 3.665054009090459*^9}, {
   3.665054056983333*^9, 3.665054057373423*^9}, {3.665054204778191*^9, 
   3.6650542056519947`*^9}, {3.6650543853088303`*^9, 3.66505449343711*^9}, {
   3.665054523915968*^9, 3.6650548448407907`*^9}, {3.665054910718199*^9, 
   3.665054915835103*^9}, {3.66505495546939*^9, 3.665055040963511*^9}, {
   3.665055117377318*^9, 3.6650552845346527`*^9}, {3.665055318902067*^9, 
   3.66505539268896*^9}, {3.665055474838262*^9, 3.665055497456004*^9}, {
   3.6650556305066757`*^9, 3.665055799012884*^9}, {3.665055840410983*^9, 
   3.6650558444074173`*^9}, {3.6650559061207952`*^9, 3.665055916648209*^9}, {
   3.66505640585524*^9, 3.665056424514122*^9}, {3.6650564727007713`*^9, 
   3.6650564738556633`*^9}, {3.665056510613793*^9, 3.665056583106029*^9}, {
   3.6650566170621367`*^9, 3.665056683729856*^9}, {3.665056881476763*^9, 
   3.665056922817486*^9}, {3.6650569790887136`*^9, 3.665057089386037*^9}, {
   3.665057248614955*^9, 3.665057339232409*^9}, {3.665057520312565*^9, 
   3.6650575254611387`*^9}, {3.6650576217320538`*^9, 
   3.6650576476961718`*^9}, {3.665058086857005*^9, 3.665058100971177*^9}, {
   3.665058222124956*^9, 3.665058256645944*^9}, 3.665058386800208*^9, {
   3.6650626865294037`*^9, 3.665062697539329*^9}, 3.665062875015723*^9, {
   3.665062917551675*^9, 3.6650630640884953`*^9}, {3.665063094388721*^9, 
   3.665063113110751*^9}, {3.665067743324172*^9, 3.665067762001944*^9}, {
   3.665068044803728*^9, 3.665068055090209*^9}, {3.665068346934929*^9, 
   3.665068349025299*^9}, {3.665068417034402*^9, 3.665068421857574*^9}, {
   3.665068492924306*^9, 3.6650685126170607`*^9}, {3.6650685836674023`*^9, 
   3.665068674988962*^9}, {3.665068774559569*^9, 3.665068775210693*^9}, {
   3.665068930181901*^9, 3.6650689328908777`*^9}, {3.665069394430477*^9, 
   3.665069420289525*^9}, {3.665069509944121*^9, 3.665069516876985*^9}, {
   3.665069696793598*^9, 3.6650697660220127`*^9}, {3.665069806590724*^9, 
   3.665069816185161*^9}, {3.6650702654497538`*^9, 3.665070282773279*^9}, {
   3.6650704090665073`*^9, 3.665070426171681*^9}, {3.665070808639783*^9, 
   3.665070850693446*^9}, {3.6650711046804543`*^9, 3.665071185243664*^9}, {
   3.665072937627512*^9, 3.66507301019538*^9}, {3.665073268806332*^9, 
   3.6650733287975693`*^9}, {3.665073369202026*^9, 3.665073398208446*^9}, {
   3.665073476312708*^9, 3.665073491183202*^9}, {3.665074018410283*^9, 
   3.6650740353714037`*^9}, {3.665074084856187*^9, 3.6650741257104607`*^9}, {
   3.6650741789884987`*^9, 3.665074196809621*^9}, {3.6650746936470337`*^9, 
   3.665074922080101*^9}, {3.665074955800531*^9, 3.665075114102572*^9}, {
   3.665075539100403*^9, 3.665075542633052*^9}, {3.665075650058984*^9, 
   3.6650756599797087`*^9}, {3.665075696771199*^9, 3.665075698338806*^9}, {
   3.6650758174845*^9, 3.665075818638989*^9}, {3.665075850640841*^9, 
   3.665075859552603*^9}, {3.665075911253875*^9, 3.665075990176453*^9}, {
   3.665076033901205*^9, 3.665076035131044*^9}, {3.665076073344365*^9, 
   3.665076087093484*^9}, {3.665076231094141*^9, 3.665076438506474*^9}, {
   3.6650765621268177`*^9, 3.665076562870751*^9}, 3.665076969701899*^9, 
   3.665077064977026*^9, 3.665077175500764*^9, {3.6650772057605953`*^9, 
   3.665077207256618*^9}, 3.665077727654277*^9, {3.665078520025464*^9, 
   3.665078542453808*^9}}]
},
WindowSize->{960, 1016},
WindowMargins->{{Automatic, -10}, {Automatic, -8}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 62714, 1515, 9202, "Input"]
}
]
*)

(* End of internal cache information *)
