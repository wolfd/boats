(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42484,       1056]
NotebookOptionsPosition[     42242,       1043]
NotebookOutlinePosition[     42582,       1058]
CellTagsIndexPosition[     42539,       1055]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<BoatContext`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"DEBUG", " ", "THING"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "debug", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"debug", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"debug", "[", "code_", "]"}], ":=", 
   RowBox[{"Internal`InheritedBlock", "[", 
    RowBox[{
     RowBox[{"{", "Message", "}"}], ",", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "inMessage", "}"}], ",", 
        RowBox[{
         RowBox[{"Unprotect", "[", "Message", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Message", "[", "args___", "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Hold", "[", "args", "]"}], "]"}], ",", "_$Off"}], 
             "]"}]}]}], ":=", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"inMessage", "=", "True"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shallow", "/@", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"HoldForm", "[", 
                    RowBox[{"f_", "[", "___", "]"}], "]"}], "\[RuleDelayed]", 
                    
                    RowBox[{"HoldForm", "[", "f", "]"}]}], ",", "1"}], 
                    "]"}]}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Short", ",", 
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "Red"}], "]"}]}], 
                  "}"}], "&"}], "@", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Stack", "[", "_", "]"}], ",", 
                    RowBox[{"-", "7"}]}], "]"}], ",", "4"}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Message", "[", "args", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Throw", "[", 
               RowBox[{"$Failed", ",", "Message"}], "]"}], ";"}]}], "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"TrueQ", "[", "inMessage", "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Protect", "[", "Message", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Catch", "[", 
       RowBox[{
        RowBox[{"StackComplete", "[", "code", "]"}], ",", "Message"}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Standard", " ", "Boat", " ", "Library"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelNeeds", "[", "\"\<CUDALink`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "point", " ", "cloud", " ", "from", " ", 
    "BoundaryMeshRegion"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointCloud", "[", 
     RowBox[{
      RowBox[{"reg_", "?", "RegionQ"}], ",", "numPoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"RandomPoint", "[", 
     RowBox[{"reg", ",", "numPoints"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "sortPoints", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sortPoints", "[", 
     RowBox[{"pts_", ",", "normal_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sortPoints", "[", 
      RowBox[{"pts", ",", "normal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"False", ",", "\[IndentingNewLine]", 
       RowBox[{"CUDASort", "[", 
        RowBox[{"CUDADot", "[", 
         RowBox[{"pts", ",", "normal"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "normal"}], "&"}], "/@", "pts"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "waterLineOld", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "index", " ", "that", " ", "puts", " ", "a", 
    " ", "certain", " ", "portion", " ", "of", " ", "the", " ", "volume", " ",
     "underwater"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"waterLineOld", "[", 
     RowBox[{
     "pts_", ",", "normal_", ",", "meshVolume_", ",", "volumeUnderwater_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"waterLineOld", "[", 
      RowBox[{
      "pts", ",", "normal", ",", "meshVolume", ",", "volumeUnderwater"}], 
      "]"}], "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numPoints", ",", "dists"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numPoints", "=", 
         RowBox[{
          RowBox[{"volumeUnderwater", "/", "meshVolume"}], " ", "*", " ", 
          RowBox[{"Length", "[", "pts", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dists", "=", 
         RowBox[{"sortPoints", "[", 
          RowBox[{"pts", ",", "normal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Possible", " ", 
          RowBox[{"improvement", ":", " ", 
           RowBox[{
           "linear", " ", "interpolate", " ", "between", " ", "values", " ", 
            "at", " ", "two", " ", "points"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dists", "[", 
         RowBox[{"[", 
          RowBox[{"Floor", "[", "numPoints", "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "waterLine", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"waterLine", "[", 
     RowBox[{"boat_", ",", "normal_", ",", "desiredVolumeUnderwater_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"waterLine", "[", 
      RowBox[{"boat", ",", "normal", ",", "desiredVolumeUnderwater"}], "]"}], 
     "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "bPoints", ",", "fullySubmergedVolume", 
         ",", "indexOfWaterLine", ",", "pointDistances"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Only", " ", "one", " ", "buoy", " ", "object", " ", "per", " ", 
           "boat", " ", "is", " ", "allowed"}], ",", " ", 
          RowBox[{
          "due", " ", "to", " ", "different", " ", "point", " ", "masses"}]}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "buoys", "]"}], "\[NotEqual]", "1"}], ",", 
          RowBox[{
          "Throw", "[", "\"\<No don't do that, one buoy per boat please\>\"", 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "These", " ", "operations", " ", "are", " ", "for", " ", "many", 
           " ", "buoys"}], ",", " ", 
          RowBox[{
          "but", " ", "only", " ", "one", " ", "buoy", " ", "is", " ", 
           "valid"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fullySubmergedVolume", "=", 
         RowBox[{"volume", "/.", "buoy"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bPoints", "=", 
         RowBox[{"points", "/.", "buoy"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "how", " ", "many", " ", "points", " ", "are", " ", 
          "underwater"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexOfWaterLine", "=", 
         RowBox[{
          RowBox[{"desiredVolumeUnderwater", "/", "fullySubmergedVolume"}], 
          "*", 
          RowBox[{"Length", "[", "bPoints", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Index", " ", "must", " ", "be", " ", "in", " ", "range", " ", "of", 
          " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indexOfWaterLine", "<", "1"}], ",", 
          RowBox[{"Throw", "[", "\"\<Index not >= 1\>\"", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indexOfWaterLine", ">", 
           RowBox[{"Length", "[", "bPoints", "]"}]}], ",", 
          RowBox[{"Throw", "[", "\"\<Index > number of points\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pointDistances", "=", 
         RowBox[{"sortPoints", "[", 
          RowBox[{"bPoints", ",", "normal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Possible", " ", 
          RowBox[{"improvement", ":", " ", 
           RowBox[{
           "linear", " ", "interpolate", " ", "between", " ", "values", " ", 
            "at", " ", "two", " ", "points"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pointDistances", "[", 
         RowBox[{"[", 
          RowBox[{"Floor", "[", "indexOfWaterLine", "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateVolumeUnderwater", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateVolumeUnderwater", "[", "boat_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"boatMass", ",", "displacedWaterVolume"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"boatMass", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"p", "[", "mass", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{"Select", "[", 
              RowBox[{"boat", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
                 "\"\<PointMass\>\""}], "&"}]}], "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"displacedWaterVolume", "=", 
         RowBox[{"boatMass", "/", "waterDensity"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateWaterLine", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calculateWaterLine", "[", 
    RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"calculateWaterLine", "[", 
     RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"waterLine", "[", 
     RowBox[{"boat", ",", "wNormal", ",", 
      RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateForces", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateForces", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateForce", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "weightForces", ",", 
         "buoyancyForce"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "the", " ", "forces"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoyancyForce", "=", 
         RowBox[{
          RowBox[{"calculateVolumeUnderwater", "[", "boat", "]"}], "*", 
          "waterDensity", "*", "g", "*", "wNormal"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"weightForces", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", 
            RowBox[{"(", 
             RowBox[{"g", "*", 
              RowBox[{"-", "wNormal"}]}], ")"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"mass", "/.", "masses"}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Tricky", " ", "replacement", " ", "bullshit"}], " ", "*)"}],
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wfs", "\[Rule]", " ", "weightForces"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"bf", "\[Rule]", "buoyancyForce"}]}], "\[IndentingNewLine]",
          "|>"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "points", " ", "of", " ", "the", " ", "buoyHull", 
    " ", "of", " ", "a", " ", "boat", " ", "when", " ", "translational", " ", 
    "forces", " ", "are", " ", "at", " ", "equib"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "pointsBelowWaterLine", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsBelowWaterLine", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pointsBelowWaterLine", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"buoy", ",", "waterHeight"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoy", "=", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"boat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"waterHeight", "=", 
         RowBox[{"calculateWaterLine", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Dot", " ", "products"}], ",", " ", 
          RowBox[{
          "get", " ", "all", " ", "points", " ", "that", " ", "are", " ", 
           "below", " ", "the", " ", "water", " ", "height"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pointsBelowWater", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"points", "/.", "buoy"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", ".", "wNormal"}], "<=", "waterHeight"}], "&"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateCOM", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateCOM", "[", "boat_", "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"calculateCOM", "[", "boat", "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"masses", ",", "coms", ",", "ms"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coms", "=", 
         RowBox[{"com", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ms", "=", 
         RowBox[{"mass", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{"coms", "*", "ms"}], ")"}]}], ")"}], "/", 
         "\[IndentingNewLine]", 
         RowBox[{"Plus", "@@", "ms"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "COB", " ", "of", " ", "a", " ", "boat", " ", 
    "when", " ", "translational", " ", "forces", " ", "are", " ", "at", " ", 
    "equib"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateCOB", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateCOB", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateCOB", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "points", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"points", "=", 
         RowBox[{"pointsBelowWaterLine", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "points"}], "}"}]}], "]"}], "/", 
           RowBox[{"Length", "[", "points", "]"}]}], ",", 
          "\"\<Centimeters\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateMoments", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateMoments", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateMoments", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "forces", ",", "buoyancy", 
         ",", "weights", ",", "buoyR", ",", "buoyMoment", ",", "weightsR", 
         ",", "weightsMoments"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "the", " ", "forces"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"forces", "=", 
         RowBox[{"calculateForces", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"weights", "=", 
         RowBox[{"wfs", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"buoyancy", "=", 
         RowBox[{"bf", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Buoyancy", " ", "moment"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoyR", "=", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"buoyMoment", "=", 
         RowBox[{"Cross", "[", 
          RowBox[{"buoyR", ",", "buoyancy"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "weights", " ", "moments"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"weightsR", "=", 
         RowBox[{"com", "/.", "masses"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"weightsMoments", "=", 
         RowBox[{"Cross", "@@@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"weightsR", ",", "weights"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Return", " ", "the", " ", "moments"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Prepend", "[", 
         RowBox[{"weightsMoments", ",", "buoyMoment"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightingArm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rightingArm", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rightingArm", "[", 
      RowBox[{"boat", ",", "wNormal"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "buoys", ",", "buoy", ",", "masses", ",", "cob", ",", "com", ",", 
         "left", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"buoys", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Assume", " ", "prior", " ", "exception", " ", "thrown", " ", "if", 
          " ", "not", " ", "1", " ", "element"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"buoy", "=", 
         RowBox[{"buoys", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
             "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"cob", "=", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"com", "=", 
         RowBox[{"calculateCOM", "[", "boat", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"left", "=", 
         RowBox[{"wNormal", "\[Cross]", 
          RowBox[{"(", 
           RowBox[{"front", "/.", "buoy"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"cob", "-", "com"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"-", 
         RowBox[{"r", ".", "left"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "calculateAVS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateAVS", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", "range_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculateAVS", "[", 
      RowBox[{"boat", ",", "samplePoints", ",", "range"}], "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"maxAngle", "=", "Pi"}], ",", "avses", ",", "interp"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"avses", "=", 
         RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rightingArm", "[", 
            RowBox[{"boat", ",", 
             RowBox[{"Normalize", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], 
              "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", 
             RowBox[{"range", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"range", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"range", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"range", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
              "samplePoints"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListInterpolation", "[", "\[IndentingNewLine]", 
         RowBox[{"avses", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotCircleAVS", "[", 
    RowBox[{"boat_", ",", "samplePoints_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"plotAVS", "[", 
    RowBox[{"boat", ",", "samplePoints", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotAVS", "[", 
     RowBox[{"boat_", ",", "samplePoints_", ",", "range_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"maxAngle", "=", "Pi"}], ",", "avses", ",", "interp"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interp", "=", 
        RowBox[{"calculateAVS", "[", 
         RowBox[{"boat", ",", "samplePoints", ",", "range"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interp", "[", "\[Theta]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<AVS\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"range", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "8"}]}], 
             "]"}], ",", "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"manyBoats", "[", 
     RowBox[{"boat_", ",", "samplePoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxAngle", "=", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"renderBoatWithForces", "[", 
         RowBox[{"boat", ",", 
          RowBox[{"Normalize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"-", "maxAngle"}], ",", "maxAngle", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"maxAngle", "*", "2"}], ")"}], "/", "samplePoints"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderBoat", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "wl", ",", "waterPlane", ",", "pointMassParts", ",", "buoyParts", ",", 
        "cob", ",", "frontVec"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Calculate", " ", "waterline", " ", "to", " ", "plot", " ", "plane", 
        " ", "on"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"wl", "=", 
        RowBox[{"calculateWaterLine", "[", 
         RowBox[{"boat", ",", "wNormal"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"waterPlane", "=", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
          RowBox[{"HalfSpace", "[", 
           RowBox[{"wNormal", ",", 
            RowBox[{"wNormal", "*", "wl"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Grab", " ", "all", " ", "point", " ", "masses", " ", "to", " ", 
         "render"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pointMassParts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"boat", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "type", "]"}], "\[Equal]", 
            "\"\<PointMass\>\""}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Render", " ", "buoy"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"buoyParts", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"boat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cob", "=", 
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"calculateCOB", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Render", " ", "front", " ", "vector"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"frontVec", "=", 
        RowBox[{"{", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"cob", ",", 
            RowBox[{"cob", "+", 
             RowBox[{"(", 
              RowBox[{"front", "/.", "buoyParts"}], ")"}]}]}], "}"}], "]"}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"waterPlane", ",", 
           RowBox[{"render", "/.", "pointMassParts"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"cobRender", "/.", "buoyParts"}], ")"}], "@", "cob"}], 
           ",", "\[IndentingNewLine]", "frontVec"}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", "Above"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderBoatWithForces", "[", 
     RowBox[{"boat_", ",", "wNormal_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "front", ",", "forces", ",", "wForces", ",", "bForce", ",", 
        "momentSum", ",", "com", ",", "scale", ",", "arrow", ",", "text", ",",
         "wVecs", ",", "bVec", ",", "mVecs", ",", "mText"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"front", "=", 
        RowBox[{"front", "/.", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"boat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "type", "]"}], "\[Equal]", "\"\<Buoy\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"forces", "=", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"calculateForces", "[", 
           RowBox[{"boat", ",", "wNormal"}], "]"}], ",", "\"\<Newtons\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"wForces", "=", 
        RowBox[{"wfs", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bForce", "=", 
        RowBox[{"bf", "/.", "forces"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"momentSum", "=", 
        RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plus", "@@", 
           RowBox[{"calculateMoments", "[", 
            RowBox[{"boat", ",", "wNormal"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\"\<NewtonMeters\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"com", "=", 
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"calculateCOM", "[", "boat", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"arrow", "=", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"com", ",", 
            RowBox[{"com", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"QuantityMagnitude", "[", "#", "]"}], "*", "scale"}], 
              ")"}]}]}], "}"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"text", "=", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#", ",", 
           RowBox[{"com", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"QuantityMagnitude", "[", "#", "]"}], "*", "scale"}], 
             ")"}]}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"wVecs", "=", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"arrow", "/@", "wForces"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bVec", "=", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"arrow", "@", "bForce"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Arbitrary", " ", "numbers", " ", "to", " ", "scale"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mVecs", "=", 
        RowBox[{"{", 
         RowBox[{"Purple", ",", 
          RowBox[{"arrow", "@", 
           RowBox[{"(", 
            RowBox[{"momentSum", "*", "20"}], ")"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mText", "=", 
        RowBox[{"{", 
         RowBox[{"text", "@", "momentSum"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"renderBoat", "[", 
          RowBox[{"boat", ",", "wNormal"}], "]"}], ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"wVecs", ",", "bVec", ",", "mVecs"}], "}"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.664813299496937*^9, 3.6648133170510674`*^9}, {
   3.66481350271585*^9, 3.664813508043021*^9}, {3.664814672840811*^9, 
   3.6648146739448757`*^9}, {3.664814711701421*^9, 3.664814734598516*^9}, {
   3.664814795939459*^9, 3.664814802663377*^9}, {3.664814852468903*^9, 
   3.664814872853755*^9}, {3.664814931411129*^9, 3.664814945699575*^9}, {
   3.664814984520199*^9, 3.664814995588686*^9}, {3.664815039581442*^9, 
   3.664815052791363*^9}, {3.664815101962479*^9, 3.664815124852728*^9}, {
   3.664815286900111*^9, 3.6648152927645273`*^9}, {3.6648154919480143`*^9, 
   3.6648156478657627`*^9}, {3.664815732893681*^9, 3.6648157330732718`*^9}, {
   3.664815771068974*^9, 3.664815779392758*^9}, 3.664815850460359*^9, {
   3.664815931513006*^9, 3.664815933768796*^9}, {3.6648880641112537`*^9, 
   3.6648882343374643`*^9}, {3.6648882926707163`*^9, 3.664888319009009*^9}, {
   3.664888394672628*^9, 3.664888480201806*^9}, {3.664888591280257*^9, 
   3.66488859264111*^9}, {3.6648888133280153`*^9, 3.664888867999805*^9}, {
   3.664909350225074*^9, 3.664909384945225*^9}, {3.664909480356393*^9, 
   3.664909521744224*^9}, {3.6649095579491177`*^9, 3.664909593831678*^9}, {
   3.664909642840949*^9, 3.664909678392852*^9}, {3.664909734698287*^9, 
   3.664909735306671*^9}, {3.664909781405867*^9, 3.66490979243357*^9}, {
   3.664909873664386*^9, 3.664909896201416*^9}, {3.664909941975493*^9, 
   3.664910024468048*^9}, {3.6649102702786407`*^9, 3.664910273537225*^9}, {
   3.664910646529241*^9, 3.664910706856591*^9}, {3.664910855055039*^9, 
   3.664910856417511*^9}, {3.664910968523501*^9, 3.664911004678432*^9}, {
   3.664911107672545*^9, 3.664911108988451*^9}, {3.664911189888356*^9, 
   3.6649112155614347`*^9}, {3.664911303591086*^9, 3.6649113192663527`*^9}, {
   3.6649119772896357`*^9, 3.664911992345685*^9}, 3.6649122416253023`*^9, {
   3.6649127779134207`*^9, 3.664912780459365*^9}, {3.664912816233697*^9, 
   3.664912817116675*^9}, {3.664915855720974*^9, 3.664915889340877*^9}, {
   3.6649165817587442`*^9, 3.6649165833106003`*^9}, {3.664916734097003*^9, 
   3.664916804078079*^9}, {3.6649169754324713`*^9, 3.664916976414856*^9}, {
   3.66491701538486*^9, 3.664917166987507*^9}, {3.664917215955248*^9, 
   3.6649172172397757`*^9}, {3.66491747583464*^9, 3.66491750582405*^9}, {
   3.664917572286017*^9, 3.6649176161853313`*^9}, {3.664917687054831*^9, 
   3.66491776105558*^9}, {3.6649177952342176`*^9, 3.66491779710802*^9}, {
   3.6649689947776823`*^9, 3.664969248723855*^9}, {3.66496930557377*^9, 
   3.664969317283692*^9}}]
},
WindowSize->{956, 1016},
WindowMargins->{{Automatic, -10}, {Automatic, -8}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 41680, 1021, 6836, "Input"]
}
]
*)

(* End of internal cache information *)
